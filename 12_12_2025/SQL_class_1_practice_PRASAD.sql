----TASK-1----
----creating the table and inseting the vaues----

CREATE TABLE TTT_23RD_BATCH (
ID BIGINT GENERATED ALWAYS AS IDENTITY,
NAME VARCHAR(50),
DEPT VARCHAR(50),
COURSE VARCHAR(100),
DATE_OF_JOIN DATE,
HOME_TOWN VARCHAR(50)
);

SELECT * FROM TTT_23RD_BATCH;

INSERT INTO TTT_23RD_BATCH 
(NAME, DEPT, COURSE, DATE_OF_JOIN, HOME_TOWN) 
VALUES ('PRASAD POTTELLA', 'IT', 'DATA ENGINEER', '08-10-2025', 'VEMKATAGIRI');

INSERT INTO TTT_23RD_BATCH 
(NAME, DEPT, COURSE, DATE_OF_JOIN, HOME_TOWN) 
VALUES ('PAVAN DANAM', 'MCA', 'DATA ENGINEER', '07-11-2025', 'NELLORE'),
('AKSHIT', 'CSE', 'DATA ENGINEER', '01-12-2025', 'DEHRADUN'),
('VENKATESH', 'MCA', 'DATA ENGINEER', '01-10-202', 'BHIMAVARAM'),
('TANISHQ VARMA', 'CSE', 'DATA ENGINEER', '20-11-2025', 'HYDERABAD'),
('SRIVIDYA', 'BSC', 'DATA ENGINEER', '20-09-2025', 'NELLORE'),
('X', 'B.TECH', 'DATA ENGINEER', '03-12-2025', 'Y')
;

DROP TABLE TTT_23RD_BATCH;

INSERT INTO TTT_23RD_BATCH 
(NAME, DEPT, COURSE, DATE_OF_JOIN, HOME_TOWN) 
VALUES ('VENKATESH', 'MCA', 'DATA ENGINEER', '01-10-2025', 'BHIMAVARAM');

TRUNCATE TABLE TTT_23RD_BATCH
WHERE ID = '4';


----TASK-2----
---all the commonly used ways to DELETE records (rows)----

DELETE FROM TTT_23RD_BATCH
WHERE ID = '4';

DELETE FROM TTT_23RD_BATCH
WHERE ID IN (3, 5, 7);

SELECT * FROM TTT_23RD_BATCH;

DELETE FROM TTT_23RD_BATCH
WHERE DEPT = 'MCA';

DELETE FROM TTT_23RD_BATCH
WHERE DEPT = 'IT' AND COURSE = 'DATA ENGINEER';

DELETE FROM TTT_23RD_BATCH;

INSERT INTO TTT_23RD_BATCH 
(NAME, DEPT, COURSE, DATE_OF_JOIN, HOME_TOWN) 
VALUES ('PRASAD POTTELLA', 'IT', 'DATA ENGINEER', '08-10-2025', 'VEMKATAGIRI'),
('PAVAN DANAM', 'MCA', 'DATA ENGINEER', '07-11-2025', 'NELLORE'),
('AKSHIT', 'CSE', 'DATA ENGINEER', '01-12-2025', 'DEHRADUN'),
('VENKATESH', 'MCA', 'DATA ENGINEER', '01-10-2025', 'BHIMAVARAM'),
('TANISHQ VARMA', 'CSE', 'DATA ENGINEER', '20-11-2025', 'HYDERABAD'),
('SRIVIDYA', 'BSC', 'DATA ENGINEER', '20-09-2025', 'NELLORE'),
('X', 'B.TECH', 'DATA ENGINEER', '03-12-2025', 'Y')
;

TRUNCATE TABLE TTT_23RD_BATCH;

INSERT INTO TTT_23RD_BATCH 
(ID, NAME, DEPT, COURSE, DATE_OF_JOIN, HOME_TOWN) 
VALUES (1, 'PRASAD POTTELLA', 'IT', 'DATA ENGINEER', '08-10-2025', 'VEMKATAGIRI'),
(2, 'PAVAN DANAM', 'MCA', 'DATA ENGINEER', '07-11-2025', 'NELLORE'),
(3, 'AKSHIT', 'CSE', 'DATA ENGINEER', '01-12-2025', 'DEHRADUN'),
(4, 'VENKATESH', 'MCA', 'DATA ENGINEER', '01-10-2025', 'BHIMAVARAM'),
(5, 'TANISHQ VARMA', 'CSE', 'DATA ENGINEER', '20-11-2025', 'HYDERABAD'),
(5, 'SRIVIDYA', 'BSC', 'DATA ENGINEER', '20-09-2025', 'NELLORE'),
(6, 'HARSHITHA', 'B.TECH', 'DATA ENGINEER', '03-12-2025', 'NELLORE');

SELECT * FROM TTT_23RD_BATCH;

CREATE TABLE TTT_23RD_BATCH (
ID BIGINT,
NAME VARCHAR(50),
DEPT VARCHAR(50),
COURSE VARCHAR(100),
DATE_OF_JOIN DATE,
HOME_TOWN VARCHAR(50)
);

DROP TABLE TTT_23RD_BATCH;

INSERT INTO TTT_23RD_BATCH 
(ID, NAME, DEPT, COURSE, DATE_OF_JOIN, HOME_TOWN) 
VALUES (1,'PRASAD POTTELLA', 'IT', 'DATA ENGINEER', '08-10-2025', 'VENKATAGIRI'),
(2, 'PAVAN DANAM', 'MCA', 'DATA ENGINEER', '07-11-2025', 'NELLORE'),
(3, 'AKSHIT', 'CSE', 'DATA ENGINEER', '01-12-2025', 'DEHRADUN'),
(4, 'VENKATESH', 'MCA', 'DATA ENGINEER', '01-10-2025', 'BHIMAVARAM'),
(5, 'TANISHQ VARMA', 'CSE', 'DATA ENGINEER', '20-11-2025', 'HYDERABAD'),
(6, 'SRIVIDYA', 'BSC', 'DATA ENGINEER', '20-09-2025', 'NELLORE'),
(7, 'X', 'B.TECH', 'DATA ENGINEER', '03-12-2025', 'Y')
;

DELETE FROM TTT_23RD_BATCH
WHERE NAME LIKE 'P%';

SELECT * FROM TTT_23RD_BATCH;

DELETE FROM TTT_23RD_BATCH
WHERE ID BETWEEN 1 AND 4;

DELETE FROM TTT_23RD_BATCH
WHERE COURSE IN (
	SELECT NAME FROM TTT_23RD_BATCH
	ORDER BY DATE_OF_JOIN
	LIMIT 2
);

----TASK-3----
---all the commonly used ways to UPDATE, WHERE & ORDERBY records (rows)----

UPDATE TTT_23RD_BATCH
SET COURSE = 'DATA ANALYST'
WHERE ID = 1;


SELECT * FROM TTT_23RD_BATCH;

UPDATE TTT_23RD_BATCH
SET COURSE = 'DATA ANALYST',
	DEPT = 'BCA'
WHERE ID = 2;

UPDATE TTT_23RD_BATCH
SET COURSE = 'DEVOPS'
WHERE DEPT = 'MCA';

UPDATE TTT_23RD_BATCH
SET HOME_TOWN = 'UNKNOWN'
WHERE NAME LIKE 'X%';

UPDATE TTT_23RD_BATCH
SET COURSE = 'DATA SCIENTIST';

SELECT * FROM TTT_23RD_BATCH
ORDER BY ID ASC;

UPDATE TTT_23RD_BATCH
SET HOME_TOWN = 'NOT PROVIDED'
WHERE HOME_TOWN IS NULL;

SELECT * FROM TTT_23RD_BATCH
ORDER BY NAME ASC;

SELECT * FROM TTT_23RD_BATCH
ORDER BY DATE_OF_JOIN ASC;

SELECT * FROM TTT_23RD_BATCH
ORDER BY id DESC;

SELECT COLUMN_NAME, DATA_TYPE
FROM INFORMATION_SCHEMA.COLUMNS
WHERE LOWER(TABLE_NAME) = 'TTT_23RD_BATCH';



----task-4----
----altering the table and columns---

ALTER TABLE TTT_23RD_BATCH
RENAME TO BATCH_23RD_TTT;

SELECT * FROM BATCH_23RD_TTT;

ALTER TABLE BATCH_23RD_TTT
ALTER COLUMN ID TYPE INT;

ALTER TABLE BATCH_23RD_TTT
RENAME COLUMN HOME_TOWN TO HOMETOWN;

ALTER TABLE BATCH_23RD_TTT RENAME COLUMN ID TO STUDENT_ID;
ALTER TABLE BATCH_23RD_TTT RENAME COLUMN NAME TO NAME_OF_STUDENT;
ALTER TABLE BATCH_23RD_TTT RENAME COLUMN DEPT TO DEPARTNEMT;
ALTER TABLE BATCH_23RD_TTT RENAME COLUMN COURSE TO PROGRAME;
ALTER TABLE BATCH_23RD_TTT RENAME COLUMN DATE_OF_JOIN TO JOINING_DATE;
ALTER TABLE BATCH_23RD_TTT RENAME COLUMN HOMETOWN TO NATIVE_PLACE;

---(or)---

DO $$
BEGIN
	ALTER TABLE BATCH_23RD_TTT RENAME COLUMN ID TO STUDENT_ID;
	ALTER TABLE BATCH_23RD_TTT RENAME COLUMN NAME TO NAME_OF_STUDENT;
	ALTER TABLE BATCH_23RD_TTT RENAME COLUMN DEPT TO DEPARTNEMT;
	ALTER TABLE BATCH_23RD_TTT RENAME COLUMN COURSE TO PROGRAME;
	ALTER TABLE BATCH_23RD_TTT RENAME COLUMN DATE_OF_JOIN TO JOINING_DATE;
	ALTER TABLE BATCH_23RD_TTT RENAME COLUMN HOMETOWN TO NATIVE_PLACE;
END $$;

SELECT COLUMN_NAME, DATA_TYPE, 
FROM INFORMATION_SCHEMA.COLUMNS
WHERE LOWER(TABLE_NAME) = 'BATCH_23RD_TTT';

SELECT *
FROM information_schema.columns
WHERE table_name = 'batch_23rd_ttt';

SELECT COUNT(*)
FROM BATCH_23RD_TTT;

SELECT * FROM BATCH_23RD_TTT
ORDER BY ID ASC;


----task-5----
----fetch names ending with sad without using %, LIKE or ILIKE----
CREATE TABLE EMPLOYEES (
EMPID VARCHAR(50),
EMPNAME VARCHAR(100),
DEPT VARCHAR(50),
DATE_OF_JOIN DATE,
HOMETOWN VARCHAR(100),
SALARY BIGINT
);

INSERT INTO EMPLOYEES 
(EMPID, EMPNAME, DEPT, DATE_OF_JOIN, HOMETOWN, SALARY) 
VALUES (1, 'POTTELLA PRASAD', 'IT', '08-10-2025', 'VENKATAGIRI', 71333),
(2, 'PAVAN DANAM', 'MCA', '07-11-2025', 'NELLORE', 60000),
(3, 'AKSHIT', 'CSE', '01-12-2025', 'DEHRADUN', 61000),
(4, 'VENKATESH', 'MCA', '01-10-2025', 'BHIMAVARAM', 72000),
(5, 'TANISHQ VARMA', 'CSE', '20-11-2025', 'HYDERABAD', 65000),
(6, 'SRIVIDYA', 'BSC', '20-09-2025', 'NELLORE', 110000),
(7, 'HARSHITHA', 'B.TECH', '03-12-2025', 'NELLORE', 100000);

SELECT * FROM EMPLOYEES
ORDER BY SALARY ASC;

INSERT INTO EMPLOYEES 
(EMPID, EMPNAME, DEPT, DATE_OF_JOIN, HOMETOWN, SALARY) 
VALUES (8, 'GURU PRASAD', 'CSE', '08-09-2025', 'VENKATAGIRI', 950000),
(9, 'HARI PRASAD', 'MECH', '20-10-2025', 'TIRUPATI', 990000),
(11, 'HARI PRASAD', 'MECH', '20-12-2025', 'TIRUPATI', 890000),
(10, 'RAM PRASAD', 'EEE', '18-10-2025', 'DELHI', 1050000);

---Using RIGHT() function---
SELECT * FROM EMPLOYEES
WHERE RIGHT(EMPNAME, 3) = 'SAD';

---Using substring()---
SELECT * FROM EMPLOYEES
WHERE SUBSTRING(EMPNAME FROM '.{3}$') = 'SAD';

---Using reverse()---
SELECT * FROM EMPLOYEES
WHERE LEFT(REVERSE(EMPNAME), 3) = 'DAS';

---Using POSIX regex match (~)---
SELECT * FROM EMPLOYEES
WHERE EMPNAME ~ 'SAD$';

---case-insensitive match without ILIKE---
SELECT * FROM EMPLOYEES
WHERE EMPNAME ~* 'sad$';


----task-6----
---fetch all employees whose salary is between 6000 and 10000, but NOT equal to 6000 or 10000---

---using strict comparison operators---
SELECT * FROM EMPLOYEES
WHERE SALARY > 60000
	AND SALARY < 100000;

---using NOT IN with BETWEEN---
SELECT * FROM EMPLOYEES
WHERE SALARY BETWEEN 60000 AND 100000
	AND SALARY NOT IN (60000, 100000);

---using <> operator---
SELECT * FROM EMPLOYEES
WHERE SALARY BETWEEN 60000 AND 100000
	AND SALARY <> 60000
	AND SALARY <> 100000;


---------------------------------------------------
SELECT DISTINCT DEPT FROM EMPLOYEES;

SELECT MAX(SALARY) FROM EMPLOYEES;

SELECT * FROM EMPLOYEES
WHERE SALARY = 890000;

SELECT * FROM EMPLOYEES LIMIT 10;

SELECT * FROM EMPLOYEES
WHERE EMPNAME AND SALARY = 61000;

SELECT * FROM EMPLOYEES;
WHERE EMPNAME = 'AKSHIT' AND SALARY = 61000;

SELECT * FROM EMPLOYEES
WHERE EMPNAME = 'PAVAN DANAM' OR SALARY = 6100000;

SELECT * FROM EMPLOYEES
WHERE EMPNAME <> 'PAVAN DANAM';

SELECT * FROM EMPLOYEES
WHERE EMPNAME != NULL;

SELECT * FROM EMPLOYEES
WHERE EMPNAME NOT IN ('POTTELLA PRASAD', 'SRIVIDYA');

SELECT * FROM EMPLOYEES
WHERE EMPNAME = 'POTTELLA PRASAD' OR SALARY = 61000;


------------------------------------
-----joins------
CREATE TABLE IF NOT EXISTS ADDRESS
(
    ADDRESS_ID       VARCHAR(20) PRIMARY KEY,
	STREET           VARCHAR(250),
	CITY             VARCHAR(100),
	STATE            VARCHAR(100),
	COUNTRY          VARCHAR(100)
);

DROP TABLE ADDRESS CASCADE;

SELECT * FROM ADDRESS;

INSERT INTO ADDRESS VALUES
    ('ADR1001','44940 Bluestem Circle','Baton Rouge','Louisiana','United States'),
    ('ADR1002','029 Kropf Point','Richmond','Virginia','United States'),
    ('ADR1003','96 Jay Road','Dallas','Texas','United States'),
    ('ADR1004','15 Harbort Lane','Roanoke','Virginia','United States'),
    ('ADR1005','3 Vermont Plaza','Atlanta','Georgia','United States'),
    ('ADR1006','55 Sycamore Trail','Seattle','Washington','United States'),
    ('ADR1007','6 Pearson Way','San Diego','California','United States'),
    ('ADR1008','71 Union Park','Rochester','New York','United States'),
    ('ADR1009','8 Roth Trail','Naples','Florida','United States'),
    ('ADR1010','0004 Redwing Circle','Houston','Texas','United States'),
	('ADR1011','0005 Redwine Circle','Houston','Texas','United Kingdo');
	
CREATE TABLE IF NOT EXISTS SCHOOL
(
    SCHOOL_ID         VARCHAR(20) PRIMARY KEY,
	SCHOOL_NAME       VARCHAR(100) NOT NULL,
	EDUCATION_BOARD   VARCHAR(80),
	ADDRESS_ID        VARCHAR(20),
	CONSTRAINT FK_SCHOOL_ADDR FOREIGN KEY(ADDRESS_ID) REFERENCES ADDRESS(ADDRESS_ID)
);

DROP TABLE SCHOOL CASCADE;

SELECT * FROM SCHOOL;

INSERT INTO SCHOOL (SCHOOL_ID, SCHOOL_NAME, EDUCATION_BOARD, ADDRESS_ID) VALUES 
('SCHL1001',  'NOBLE SCHOOL',  'CBSE',  'ADR1001'),
('SCHL1002',  'NOBLE SCHOOL',  'CBSE',  'ADR1002'),
('SCHL1003',  'NOBLE SCHOOL',  'CBSE',  'ADR1003'),
('SCHL1004',  'NOBLE SCHOOL',  'CBSE',  'ADR1004'),
('SCHL1005',  'NOBLE SCHOOL',  'CBSE',  'ADR1005'),
('SCHL1006',  'NOBLE SCHOOL',  'CBSE',  'ADR1006'),
('SCHL1007',  'NOBLE SCHOOL',  'CBSE',  'ADR1007'),
('SCHL1008',  'NOBLE SCHOOL',  'CBSE',  'ADR1008'),
('SCHL1009',  'NOBLE SCHOOL',  'CBSE',  'ADR1009'),
('SCHL1010',  'NOBLE SCHOOL',  'CBSE',  'ADR1010'),
('SCHL1011',  'PM-SHRI SCHOOL',  'ICSE',  'ADR1011');

CREATE TABLE IF NOT EXISTS STAFF
(
	STAFF_ID         VARCHAR(20),
	STAFF_TYPE       VARCHAR(30),
  	SCHOOL_ID        VARCHAR(20),
  	FIRST_NAME       VARCHAR(100) NOT NULL,
  	LAST_NAME        VARCHAR(100) NOT NULL,
  	AGE              INT,
  	DOB              DATE,
  	GENDER           VARCHAR(10) CHECK (GENDER IN ('M', 'F', 'Male', 'Female')),
  	JOIN_DATE        DATE,
  	ADDRESS_ID       VARCHAR(20),
  	CONSTRAINT PK_STAFF PRIMARY KEY(STAFF_ID),
  	CONSTRAINT FK_STAFF_SCHL FOREIGN KEY(SCHOOL_ID) REFERENCES SCHOOL(SCHOOL_ID),
  	CONSTRAINT FK_STAFF_ADDR FOREIGN KEY(ADDRESS_ID) REFERENCES ADDRESS(ADDRESS_ID)
);

DROP TABLE STAFF CASCADE;

SELECT * FROM STAFF;

INSERT INTO STAFF (STAFF_ID, STAFF_TYPE, SCHOOL_ID, FIRST_NAME, LAST_NAME, AGE, DOB, GENDER, JOIN_DATE, ADDRESS_ID) VALUES
('STF1001', 'Non-Teaching', 'SCHL1001', 'Shamala', 'Devi', '56', TO_DATE('03/09/1964', 'DD/MM/YYYY'), 'F', TO_DATE('05/06/2015', 'DD/MM/YYYY'), 'ADR1001'),
('STF1002', 'Teaching', 'SCHL1001', 'Violet', 'Mascarenhas', '33', TO_DATE('01/01/1987', 'DD/MM/YYYY'), 'F', TO_DATE('02/03/2006', 'DD/MM/YYYY'), 'ADR1002'),
('STF1003', 'Teaching', 'SCHL1001', 'Shaheen', 'Maryam', '55', TO_DATE('02/02/1965', 'DD/MM/YYYY'), 'F', TO_DATE('03/04/1984', 'DD/MM/YYYY'), 'ADR1003'),
('STF1004', 'Teaching', 'SCHL1001', 'Thelma', 'Silva', '56', TO_DATE('03/03/1964', 'DD/MM/YYYY'), 'F', TO_DATE('03/05/1983', 'DD/MM/YYYY'), 'ADR1004'),
('STF1005', 'Teaching', 'SCHL1001', 'Eugine', 'Rebello', '45', TO_DATE('24/04/1975', 'DD/MM/YYYY'), 'F', TO_DATE('23/06/1994', 'DD/MM/YYYY'), 'ADR1005'),
('STF1006', 'Teaching', 'SCHL1001', 'Cynthia', 'Sequeira', '48', TO_DATE('26/04/1972', 'DD/MM/YYYY'), 'F', TO_DATE('26/06/1991', 'DD/MM/YYYY'), 'ADR1006'),
('STF1007', 'Teaching', 'SCHL1001', 'Veena', 'Bhat', '37', TO_DATE('25/04/1983', 'DD/MM/YYYY'), 'F', TO_DATE('24/06/2002', 'DD/MM/YYYY'), 'ADR1007'),
('STF1008', 'Teaching', 'SCHL1001', 'Nelson', 'Dsouza', '35', TO_DATE('25/05/1985', 'DD/MM/YYYY'), 'M', TO_DATE('24/07/2004', 'DD/MM/YYYY'), 'ADR1008'),
('STF1009', 'Teaching', 'SCHL1001', 'Mariat', 'Rodrigues', '40', TO_DATE('18/06/1980', 'DD/MM/YYYY'), 'F', TO_DATE('18/08/1999', 'DD/MM/YYYY'), 'ADR1009'),
('STF1010', 'Teaching', 'SCHL1001', 'Anita', 'Shetty', '32', TO_DATE('17/07/1988', 'DD/MM/YYYY'), 'F', TO_DATE('16/09/2007', 'DD/MM/YYYY'), 'ADR1010');



CREATE TABLE IF NOT EXISTS STAFF_SALARY
(
    STAFF_ID         VARCHAR(20) PRIMARY KEY,
	SALARY           FLOAT,
	CURRENCY         VARCHAR(5)
);

DROP TABLE STAFF_SALARY CASCADE;

SELECT * FROM STAFF_SALARY;

INSERT INTO STAFF_SALARY (STAFF_ID, SALARY, CURRENCY) VALUES
	('STF1001','15000', 'USD'),
	('STF1002','8000', 'USD'),
	('STF1003','7000', 'USD'),
	('STF1004','6000', 'USD'),
	('STF1005','11000', 'USD'),
	('STF1006','9000', 'USD'),
	('STF1007','5000', 'USD'),
	('STF1008','7000', 'USD'),
	('STF1009','8000', 'USD'),
	('STF1010','12000', 'USD');

CREATE TABLE IF NOT EXISTS SUBJECTS
(
    SUBJECT_ID       VARCHAR(20) PRIMARY KEY,
	SUBJECT_NAME     VARCHAR(50) NOT NULL
);


DROP TABLE SUBJECTS CASCADE;

SELECT * FROM SUBJECTS;

INSERT INTO SUBJECTS (SUBJECT_ID, SUBJECT_NAME) VALUES 
	('SUBJ1001',  'Mathematics'),
	('SUBJ1002',  'Science'),
	('SUBJ1003',  'Social Studies'),
	('SUBJ1004',  'English'),
	('SUBJ1005',  'Arts'),
	('SUBJ1006',  'Computer Application'),
	('SUBJ1007',  'Music'),
	('SUBJ1008',  'Reading'),
	('SUBJ1009',  'Writing'),
	('SUBJ1010',  'Psychology');

CREATE TABLE IF NOT EXISTS CLASSES
(
    CLASS_ID         VARCHAR(20),
	CLASS_NAME       VARCHAR(50) NOT NULL,
	SUBJECT_ID       VARCHAR(20),
	TEACHER_ID       VARCHAR(20),
	CONSTRAINT FK_STAFF_SUBJ FOREIGN KEY(SUBJECT_ID) REFERENCES SUBJECTS(SUBJECT_ID),
	CONSTRAINT FK_STAFF_STFF FOREIGN KEY(TEACHER_ID) REFERENCES STAFF(STAFF_ID),
	CONSTRAINT PK_CLASSES PRIMARY KEY (CLASS_ID, CLASS_NAME, SUBJECT_ID)
);

DROP TABLE CLASSES CASCADE;

SELECT * FROM CLASSES;

INSERT INTO CLASSES (CLASS_ID, CLASS_NAME, SUBJECT_ID, TEACHER_ID) VALUES 
	('CLS1001', 'Grade 1', 'SUBJ1008', 'STF1001'),
	('CLS1001', 'Grade 1', 'SUBJ1009', 'STF1001'),
	('CLS1001', 'Grade 1', 'SUBJ1004', 'STF1002'),
	('CLS1002', 'Grade 2', 'SUBJ1008', 'STF1001'),
	('CLS1002', 'Grade 2', 'SUBJ1009', 'STF1001'),
	('CLS1002', 'Grade 2', 'SUBJ1004', 'STF1002'),
	('CLS1002', 'Grade 2', 'SUBJ1007', 'STF1003'),
	('CLS1003', 'Grade 3', 'SUBJ1001', 'STF1003'),
	('CLS1003', 'Grade 3', 'SUBJ1002', 'STF1002'),
	('CLS1003', 'Grade 3', 'SUBJ1003', 'STF1003'),
	('CLS1003', 'Grade 3', 'SUBJ1004', 'STF1004'),
	('CLS1004', 'Grade 4', 'SUBJ1001', 'STF1004'),
	('CLS1004', 'Grade 4', 'SUBJ1002', 'STF1005'),
	('CLS1004', 'Grade 4', 'SUBJ1003', 'STF1006'),
	('CLS1004', 'Grade 4', 'SUBJ1004', 'STF1006'),
	('CLS1005', 'Grade 5', 'SUBJ1001', 'STF1007'),
	('CLS1005', 'Grade 5', 'SUBJ1002', 'STF1007'),
	('CLS1005', 'Grade 5', 'SUBJ1003', 'STF1008'),
	('CLS1005', 'Grade 5', 'SUBJ1004', 'STF1007'),
	('CLS1005', 'Grade 5', 'SUBJ1005', 'STF1008'),
	('CLS1005', 'Grade 5', 'SUBJ1007', 'STF1003'),
	('CLS1006', 'Grade 6', 'SUBJ1001', 'STF1004'),
	('CLS1006', 'Grade 6', 'SUBJ1002', 'STF1009'),
	('CLS1006', 'Grade 6', 'SUBJ1003', 'STF1010'),
	('CLS1006', 'Grade 6', 'SUBJ1004', 'STF1009'),
	('CLS1006', 'Grade 6', 'SUBJ1005', 'STF1008'),
	('CLS1006', 'Grade 6', 'SUBJ1007', 'STF1007'),
	('CLS1007', 'Grade 7', 'SUBJ1001', 'STF1006'),
	('CLS1007', 'Grade 7', 'SUBJ1002', 'STF1006'),
	('CLS1007', 'Grade 7', 'SUBJ1003', 'STF1005'),
	('CLS1007', 'Grade 7', 'SUBJ1004', 'STF1005'),
	('CLS1007', 'Grade 7', 'SUBJ1005', 'STF1005'),
	('CLS1007', 'Grade 7', 'SUBJ1007', 'STF1003'),
	('CLS1008', 'Grade 8', 'SUBJ1001', 'STF1009'),
	('CLS1008', 'Grade 8', 'SUBJ1002', 'STF1010'),
	('CLS1008', 'Grade 8', 'SUBJ1003', 'STF1010'),
	('CLS1008', 'Grade 8', 'SUBJ1006', 'STF1010'),
	('CLS1008', 'Grade 8', 'SUBJ1005', 'STF1003'),
	('CLS1008', 'Grade 8', 'SUBJ1007', 'STF1003'),
	('CLS1009', 'Grade 9', 'SUBJ1001', 'STF1001'),
	('CLS1009', 'Grade 9', 'SUBJ1002', 'STF1002'),
	('CLS1009', 'Grade 9', 'SUBJ1003', 'STF1003'),
	('CLS1009', 'Grade 9', 'SUBJ1006', 'STF1006'),
	('CLS1009', 'Grade 9', 'SUBJ1005', 'STF1005'),
	('CLS1009', 'Grade 9', 'SUBJ1007', 'STF1003'),
	('CLS1010', 'Grade 10', 'SUBJ1001', 'STF1001'),
	('CLS1010', 'Grade 10', 'SUBJ1002', 'STF1002'),
	('CLS1010', 'Grade 10', 'SUBJ1003', 'STF1003'),
	('CLS1010', 'Grade 10', 'SUBJ1006', 'STF1006'),
	('CLS1010', 'Grade 10', 'SUBJ1005', 'STF1005'),
	('CLS1010', 'Grade 10', 'SUBJ1007', 'STF1003');

CREATE TABLE IF NOT EXISTS STUDENTS
(
    ID               VARCHAR(20) PRIMARY KEY,
	FIRST_NAME       VARCHAR(100) NOT NULL,
	LAST_NAME        VARCHAR(100) NOT NULL,
	GENDER           VARCHAR(10) CHECK (GENDER IN ('M', 'F', 'Male', 'Female')),
	AGE              INT,
	DOB              DATE,
	GRADE            FLOAT,
	IS_ACTIVE        BOOLEAN,
	CONSTRAINT CH_STUDENTS_AGE CHECK (AGE > 0)
);

DROP TABLE STUDENTS CASCADE;

SELECT * FROM STUDENTS;

INSERT INTO STUDENTS VALUES
	('STD10001','Lindy','O''Connell','Male',6,TO_DATE('2014-01-13', 'YYYY-MM-DD')),
	('STD10002','Madison','Walder','Male',6,TO_DATE('2014-01-19', 'YYYY-MM-DD')),
	('STD10003','Marve','Sheaber','Male',6,TO_DATE('2014-03-11', 'YYYY-MM-DD')),
	('STD10004','Jesselyn','Greaterex','Female',6,TO_DATE('2014-03-31', 'YYYY-MM-DD')),
	('STD10005','Leigh','Kipling','Male',6,TO_DATE('2014-02-02', 'YYYY-MM-DD')),
	('STD10006','Hilary','Mordey','Female',6,TO_DATE('2014-04-20', 'YYYY-MM-DD')),
	('STD10007','Tull','Meeus','Male',6,TO_DATE('2014-04-10', 'YYYY-MM-DD')),
	('STD10008','Westbrook','Compfort','Male',6,TO_DATE('2014-02-16', 'YYYY-MM-DD')),
	('STD10009','Chloris','Mannakee','Female',6,TO_DATE('2014-05-16', 'YYYY-MM-DD')),
	('STD10010','Ariel','Pendre','Female',6,TO_DATE('2014-04-06', 'YYYY-MM-DD'));

CREATE TABLE IF NOT EXISTS STUDENT_CLASSES
(
    STUDENT_ID       VARCHAR(20),
	CLASS_ID         VARCHAR(20),
	CONSTRAINT UNQ_STDCLASS UNIQUE (STUDENT_ID, CLASS_ID),
	FOREIGN KEY(STUDENT_ID) REFERENCES STUDENTS(ID)
);

DROP TABLE STUDENT_CLASSES CASCADE;

SELECT * FROM STUDENT_CLASSES;

INSERT INTO STUDENT_CLASSES 
VALUES
	('STD10001','CLS1001'),
	('STD10002','CLS1001'),
	('STD10003','CLS1001'),
	('STD10004','CLS1001'),
	('STD10005','CLS1001'),
	('STD10006','CLS1001'),
	('STD10007','CLS1001'),
	('STD10008','CLS1001'),
	('STD10009','CLS1001'),
	('STD10010','CLS1001');

				
CREATE TABLE IF NOT EXISTS PARENTS
(
    ID               VARCHAR(20) PRIMARY KEY,
	FIRST_NAME       VARCHAR(100) NOT NULL,
  	LAST_NAME        VARCHAR(100) NOT NULL,
  	GENDER           VARCHAR(10),
  	ADDRESS_ID       VARCHAR(20),
  	CONSTRAINT CH_PARENTS CHECK (GENDER IN ('M', 'F', 'Male', 'Female')),
  	CONSTRAINT FK_PARENTS_ADDR FOREIGN KEY(ADDRESS_ID) REFERENCES ADDRESS(ADDRESS_ID)
);

DROP TABLE PARENTS CASCADE;

SELECT * FROM PARENTS;

INSERT INTO PARENTS (ID, FIRST_NAME, LAST_NAME, GENDER, ADDRESS_ID) VALUES 
('PRT1001', 'KRISHNAIAH', 'POTTELLA', 'M', 'ADR1001'),
('PRT1002', 'ADEMMA', 'POTTELLA', 'F', 'ADR1001'),
('PRT1003', 'SRINIVASULU', 'POTTELLA', 'M', 'ADR1002'),
('PRT1004', 'LAVANYA', 'POTTELLA', 'F', 'ADR1002'),
('PRT1005', 'VENKATESWARLU', 'POTTELLA', 'M', 'ADR1003'),
('PRT1006', 'VIJAYAMMA', 'POTTELLA', 'F', 'ADR1003'),
('PRT1007', 'GOPAL', 'POLIBOYINA', 'M', 'ADR1004'),
('PRT1008', 'SHANTHAMMA', 'POLIBOYINA', 'F', 'ADR1004'),
('PRT1009', 'CHINNAIAH', 'POLIBOYINA', 'M', 'ADR1005'),
('PRT1010', 'ESWARAMMA', 'POLIBOYINA', 'F', 'ADR1005');

CREATE TABLE IF NOT EXISTS STUDENT_PARENT
(
    STUDENT_ID       VARCHAR(20),
	PARENT_ID        VARCHAR(20),
  	CONSTRAINT UNQ_STDPARENT UNIQUE (STUDENT_ID, PARENT_ID),
  	FOREIGN KEY(STUDENT_ID) REFERENCES STUDENTS(ID),FOREIGN KEY(PARENT_ID) REFERENCES PARENTS(ID)
);

DROP TABLE STUDENT_PARENT CASCADE;

SELECT * FROM STUDENT_PARENT;

INSERT INTO STUDENT_PARENT VALUES
	('STD10001', 'PRT1001'),
	('STD10002', 'PRT1002'),
	('STD10003', 'PRT1003'),
	('STD10004', 'PRT1004'),
	('STD10005', 'PRT1005'),
	('STD10006', 'PRT1006'),
	('STD10007', 'PRT1007'),
	('STD10008', 'PRT1008'),
	('STD10009', 'PRT1009'),
	('STD10010', 'PRT1010');

---Left Join(Returns all records from the left table, and the matched records from the right table)---
SELECT SALARY, STAFF_TYPE
FROM STAFF STF
LEFT JOIN STAFF_SALARY SS ON STF.STAFF_ID=SS.STAFF_ID;

---Right Join(Returns all records from the right table, and the matched records from the left table)---
SELECT SCHOOL_ID, EDUCATION_BOARD
FROM ADDRESS ADR
RIGHT JOIN SCHOOL SL ON SL.ADDRESS_ID=ADR.ADDRESS_ID;

-----Join/inner Join(Returns records that have matching values in both tables)---
SELECT STAFF_TYPE, SALARY
FROM STAFF STF
JOIN STAFF_SALARY SS ON SS.STAFF_ID = STF.STAFF_ID;

SELECT STAFF_TYPE, SALARY
FROM STAFF STF
INNER JOIN STAFF_SALARY SS ON SS.STAFF_ID = STF.STAFF_ID;

---Full join(Returns all records when there is a match in either left or right table)
SELECT SCHOOL_ID, CITY, EDUCATION_BOARD, COUNTRY
FROM ADDRESS ADR
FULL JOIN SCHOOL SL ON SL.ADDRESS_ID=ADR.ADDRESS_ID;

---Cross join(all records from the "right" table will be returned for each record in the "left" table.)---
SELECT STREET, CITY, COUNTRY
FROM ADDRESS ADR
CROSS JOIN SCHOOL;

---Union(no duplicates and must have a same number of columns)---
SELECT STUDENT_ID, CLASS_ID
FROM STUDENT_CLASSES
UNION
SELECT FIRST_NAME, LAST_NAME
FROM STUDENTS;

SELECT STUDENT_ID, CLASS_ID
FROM STUDENT_CLASSES
UNION
SELECT FIRST_NAME, LAST_NAME
FROM STUDENTS
ORDER BY STUDENT_ID;

---Union All(allows duplicates and must have a same number of columns)---
SELECT ID, FIRST_NAME, LAST_NAME
FROM STUDENTS
UNION ALL
SELECT ID, FIRST_NAME, LAST_NAME
FROM PARENTS
ORDER BY FIRST_NAME ASC;

---Group by(to group rows that have the same values in one or more columns.)---
CREATE TABLE IF NOT EXISTS TTT(
EMP_ID VARCHAR(20),
NAME VARCHAR(50),
DEPARTMENT VARCHAR(30)
);

ALTER TABLE TTT
ADD SALARY BIGINT;

DROP TABLE TTT;

SELECT * FROM TTT;

INSERT INTO TTT(EMP_ID, NAME, DEPARTMENT, SALARY) VALUES
	('EMP1001', 'PRASAD', 'HR', 1000),
	('EMP1002', 'PAVAN_NELLORE', 'IT', 2000),
	('EMP1003', 'ASHOK', 'HR', 3000),
	('EMP1004', 'VENKATESH', 'HR', 4000),
	('EMP1005', 'AKSHIT', 'HR', 5000),
	('EMP1006', 'PAVAR_KOVVUR', 'SALE', 6000),
	('EMP1007', 'DILFI', 'HR', 7000),
	('EMP1008', 'SRIVIDYA', 'SALES', 8000),
	('EMP1009', 'HARSHITHA', 'HR', 9000),
	('EMP1010', 'SWAMY', 'HR', 10000),
	('EMP1011', 'RISHIKA', 'IT', 11000);

SELECT DEPARTMENT, MAX(SALARY)
FROM TTT
GROUP BY DEPARTMENT;

SELECT DEPARTMENT, MIN(SALARY)
FROM TTT
GROUP BY DEPARTMENT;

SELECT DEPARTMENT, COUNT(SALARY)
FROM TTT
GROUP BY DEPARTMENT;

SELECT DEPARTMENT, MIN(SALARY)
FROM TTT
GROUP BY DEPARTMENT
ORDER BY DEPARTMENT ASC;

SELECT DEPARTMENT, SUM(SALARY) AS total_salary
FROM TTT
GROUP BY DEPARTMENT
ORDER BY DEPARTMENT ASC;

SELECT DEPARTMENT, NAME, SUM(SALARY) AS total_salary
FROM TTT
GROUP BY DEPARTMENT, NAME
ORDER BY total_salary ASC;

---Having(added to SQL when WHERE clause cannot be used with aggregate functions.)
SELECT * FROM TTT_23RD_BATCH
ORDER BY ID ASC;

SELECT COUNT(ID) AS total_people, HOME_TOWN
FROM TTT_23RD_BATCH
WHERE NAME = TTT.NAME
GROUP BY HOME_TOWN
HAVING COUNT(ID) < 5
ORDER BY total_people ASC;

---Exists(used to test for the existence of any record in a sub query.)---
SELECT NAME
FROM TTT
WHERE EXISTS (
	SELECT COURSE
	FROM TTT_23RD_BATCH
	WHERE NAME = TTT.NAME
);

SELECT NAME
FROM TTT
WHERE EXISTS (
	SELECT *
	FROM TTT_23RD_BATCH
	WHERE NAME = TTT.NAME
);

(OR)

SELECT NAME
FROM TTT
WHERE NAME IN (
    SELECT NAME 
    FROM TTT_23RD_BATCH
);

---NOT EXISTS()---
SELECT NAME
FROM TTT
WHERE NOT EXISTS (
	SELECT *
	FROM TTT_23RD_BATCH
	WHERE NAME = TTT.NAME
);

print("SQL")